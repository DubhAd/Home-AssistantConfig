id: 'test_calendar_automation'
alias: 'test calendar automation'
initial_state: 'on'
trigger:
  - platform: homeassistant
    event: start
action:
  - action: calendar.get_events
    target:
      entity_id: calendar.person2_work
    data:
      start_date_time: "{{ today_at('00:00:00') }}"
      duration: 
        hours: 24
    response_variable: agenda
  - action: notify.person2
    data:
      message: >-
        {{ agenda['calendar.person2_work'].events | selectattr('summary', 'contains', 'holiday') | list | join(';') }} }}
